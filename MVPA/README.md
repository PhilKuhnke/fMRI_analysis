# Multivariate pattern analysis (MVPA)
In contrast to classical univariate analyses of fMRI data which analyze each voxel separately, MVPA looks for information represented in patterns of activity distributed across multiple voxels. Activity patterns are represented computationally as points/vectors in voxel-dimensional space (e.g. a 100-dimensional space when investigating a region of 100 voxels). MVPA offers a generally higher sensitivity than univariate analyses (due to sensitivity to *relative* activity differences between voxels), and allows to study the representational content of a brain region (rather than merely its general involvement in a cognitive function). 

There are two main types of MVPA approaches: (1) Decoding (a.k.a. classification), and (2) Representational Similarity Analysis (RSA).

## Decoding
In MVPA decoding, a machine-learning classifier (e.g. a linear support vector machine) is trained to distinguish the activation patterns for 2 (or more) classes of experimental conditions (e.g. stimuli or tasks), and tested on new data. Decoding can be performed in the whole brain, in a region-of-interest (ROI) or network, or in a "searchlight" approach (the MVPA equivalent of mass-univariate mapping, where a small ROI (e.g. sphere) is moved through the entire brain to search for brain regions containing information for the contrast-of-interest). 

This directory contains Matlab code to perform MVPA searchlight and ROI-based decoding analyses using [The Decoding Toolbox (TDT)](https://sites.google.com/site/tdtdecodingtoolbox/). The code assumes the BIDS data structure.

### Searchlight analysis:
1. *create_condition_matfiles_singleTrials.m* creates condition .mat files for SPM12, which are required for first-level analyses to create single-trial beta images. It also adds information to the events.tsv files, regarding which trial corresponds to which beta image. 
2. *first_level_script_singleTrials.m* runs a first-level (subject-level) analysis using SPM12, which creates single-trial beta images. Note that for MVPA, we typically use unsmoothed subject-level data.
3. *decoding_searchlight.m* runs an MVPA searchlight decoding analysis for each subject using single-trial beta images (created using first_level_script_singleTrials.m). 
4. *decoding_searchlight_groupLevel.m* runs a group-level t-test in each voxel on smoothed subject-level searchlight maps (generated by decoding_searchlight.m). It is generally advisable to smooth the subject-level searchlight maps as in a classical univariate analysis (e.g. FWHM = 2 * voxel size). Moreover, non-parametric t-tests are preferred; this script performs non-parametric tests using the [SnPM toolbox](https://warwick.ac.uk/fac/sci/statistics/staff/academic-research/nichols/software/snpm/). It also allows you to export 4D nifti files for non-parametric tests using [FSL's randomise](https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Randomise/UserGuide).

### ROI-based analysis:
1. *create_condition_matfiles_singleTrials.m* (as for Searchlight analysis)
2. *first_level_script_singleTrials.m* (as for Searchlight analysis)
3. *decoding_ROI.m* runs a ROI-based decoding analysis for each subject using single-trial beta images (created using first_level_script_singleTrials.m). 
4. *decoding_ROI_groupLevel.m* plots the mean decoding accuracies for each ROI and analysis across the group. The script also performs one-sample t-tests vs. chance level, as well as paired t-tests comparing the decoding accuracies between conditions (within each ROI) and between ROIs (for each condition).


## Representational similarity analysis (RSA)
TO DO: Add code & documentation for RSA


---
created by Philipp Kuhnke (2023)